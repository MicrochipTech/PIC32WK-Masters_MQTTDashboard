{"version":1,"allow_edit":false,"plugins":[],"panes":[{"title":"Potentiometer Gauge","width":1,"row":{"1":1,"2":1,"3":1,"4":1},"col":{"1":1,"2":1,"3":1,"4":1},"col_width":1,"widgets":[{"type":"gauge","settings":{"title":"Potentiometer","value":"datasources[\"devStat\"][\"msg\"][\"pot\"]","units":"position","min_value":0,"max_value":100}}]},{"title":"LED Controls","width":1,"row":{"1":15,"2":9,"3":1,"4":1},"col":{"1":1,"2":1,"3":2,"4":2},"col_width":1,"widgets":[{"type":"html","settings":{"html":"<script language=\"javascript\" type=\"text/javascript\">\nvar delay=1000; \nfunction disableLedButtons()\n{\n    document.getElementById(\"LED1On\").disabled = true;\n    document.getElementById(\"LED1Off\").disabled = true;\n    document.getElementById(\"LED2On\").disabled = true;\n    document.getElementById(\"LED2Off\").disabled = true;\n}\nfunction enableLedButtons()\n{\n    document.getElementById(\"LED1On\").disabled = false;\n    document.getElementById(\"LED1Off\").disabled = false;\n    document.getElementById(\"LED2On\").disabled = false;\n    document.getElementById(\"LED2Off\").disabled = false;\n}\nfunction LED1On()\n{\n\tdisableLedButtons();\n    message = new Paho.MQTT.Message(JSON.stringify({led1Stat:\"ON\"}));\n  \tmessage.destinationName = thingID;\n  \tpahoClient.send(message);\n    setTimeout(enableLedButtons,delay);   \n};\nfunction LED1Off()\n{\n    disableLedButtons();\n\tmessage = new Paho.MQTT.Message(JSON.stringify({led1Stat:\"OFF\"}));\n  \tmessage.destinationName = thingID;\n  \tpahoClient.send(message);\n    setTimeout(enableLedButtons,delay);   \n}\nfunction LED2On()\n{\n    disableLedButtons();\n\tmessage = new Paho.MQTT.Message(JSON.stringify({led2Stat:\"ON\"}));\n  \tmessage.destinationName = thingID;\n  \tpahoClient.send(message);\n    setTimeout(enableLedButtons,delay);   \n}\nfunction LED2Off()\n{\n    disableLedButtons();\n\tmessage = new Paho.MQTT.Message(JSON.stringify({led2Stat:\"OFF\"}));\n  \tmessage.destinationName = thingID;\n  \tpahoClient.send(message);\n    setTimeout(enableLedButtons,delay);   \n}\n</script>\n<style>\nbutton.ledOnButton{\n    height:50px; \n    width:80px;\n    background-color: #4CAF50; \n    border: none;\n    color: white;\n    border-radius: 4px;\n}\nbutton.ledOffButton{\n    height:50px; \n    width:80px;\n    background-color: #008CBA; \n    border: none;\n    color: white;\n    border-radius: 4px;\n}\nbutton:disabled {\n    opacity: 0.6;\n    background-color: #e7e7e7; \n    color: black;\n    cursor: not-allowed;\n}\n</style>\n<center>\n    <br/><br/>\n    LED1 : <button id=\"LED1On\" onclick=\"LED1On()\"  class=\"ledOnButton\" disabled>ON</button>  \n    \t   <button id=\"LED1Off\" onclick=\"LED1Off()\" class=\"ledOffButton\" disabled>OFF</button><p/>\n    LED2 : <button id=\"LED2On\" onclick=\"LED2On()\"  class=\"ledOnButton\" disabled>ON</button>  \n           <button id=\"LED2Off\" onclick=\"LED2Off()\" class=\"ledOffButton\" disabled>OFF</button>\n</center>","height":3}},{"type":"indicator","settings":{"title":"LED1 Status","value":"datasources[\"devStat\"][\"msg\"][\"led1Stat\"]","on_text":"ON","off_text":"OFF","color":"orange"}},{"type":"indicator","settings":{"title":"LED2 Status","value":"datasources[\"devStat\"][\"msg\"][\"led2Stat\"]","on_text":"ON","off_text":"OFF","color":"green"}}]},{"title":"scan code","width":1,"row":{"2":1,"3":1},"col":{"2":2,"3":3},"col_width":1,"widgets":[{"type":"html","settings":{"html":"<center>\n<br/>\n<br/>\n  <div id=\"qrcodeTable\" style=\"width:200px;height:200px;background-color:#FFFFFF;\"/>    </div>\n<br/>\n<br/>\n<p>Scan this code using a QR reader to launch this dashboard on another device </p>\n</center>\n<script>\n    var qrText;\n\tif ((typeof thingID === 'undefined') || (null===thingID)){\n        qrText=window.location.href.split(/[?#]/)[0];\n    }\n    else{\n       \tqrText=window.location.href.split(/[?#]/)[0] + \"?thingID=\" +thingID;                \n    }\n    \t\n    jQuery('#qrcodeTable').qrcode({\n    width: 150,\n    height: 150,\n    marginTop:25,\n    text: qrText\n}); \n\nfunction updateQrCode(pThingID){\n    var qrText;\n    if(null===pThingID){\n           qrText=window.location.href.split(/[?#]/)[0];\n    }\n    else{\n           qrText=window.location.href.split(/[?#]/)[0] + \"?thingID=\" +pThingID;                \n    }\n    \n \tdocument.getElementById(\"qrcodeTable\").innerHTML = \"\";\n    \n    jQuery('#qrcodeTable').qrcode({\n    width: 150,\n    height: 150,\n    marginTop:25,\n    text: qrText\n});\n}\n\n</script>\n","height":7}}]},{"title":"Temperature","width":1,"row":{"2":17,"3":9,"4":9},"col":{"2":2,"3":1,"4":1},"col_width":1,"widgets":[{"type":"text_widget","settings":{"title":"","size":"big","value":"temp=datasources[\"devStat\"][\"msg\"][\"temp\"]\ntemp=Math.round((temp*1.8)+32);\n\nif (isNaN(temp)) return datasources[\"devStat\"][\"msg\"][\"temp\"] ;\nelse return temp","sparkline":true,"animate":true,"units":"F"}}]},{"title":"device configuration","width":1,"row":{"1":25,"2":19,"3":13,"4":11},"col":{"1":1,"2":1,"3":2,"4":2},"col_width":1,"widgets":[{"type":"html","settings":{"html":"<script language=\"javascript\" type=\"text/javascript\">\nvar updateCalled=false;\nfunction updateThingID()\n{\n    disableLedButtons();\n    updateCalled=true;\n    document.getElementById(\"updatedThingID\").innerHTML=\"\";\n    document.getElementById(\"updatedThingID\").innerHTML=\"Updating ThingID and resetting listners\";\n    \n    thingID=document.getElementById(\"thingID\").value;\n    dsSettings=freeboard.getDatasourceSettings(\"devStat\");\n    dsSettings.topic=thingID;\n    freeboard.setDatasourceSettings(\"devStat\",dsSettings);\n    \n    updateQrCode(thingID);\n}\n\nfunction refreshPanels(){ /*will be called bu onConnect of paho backend*/\n    \n    if(true==updateCalled){\n        thingID=document.getElementById(\"thingID\").value;\n    \tenableLedButtons();\n    \tthingIDString=\"Currently configured thingID is: </p><center>\"+thingID+\"</center>\";\n    \n    \tdocument.getElementById(\"updatedThingID\").innerHTML=thingIDString;\n \t    document.getElementById(\"idConfigButton\").className = 'updateButton';\n    \tdocument.getElementById(\"idConfigButton\").innerHTML=\"update\";\n    \tmessage = new Paho.MQTT.Message(JSON.stringify({StatREQ:\"True\"}));\n  \t\tmessage.destinationName = thingID;\n  \t\tpahoClient.send(message);\n    }\n}\n\n</script>\n<style>\nbutton.configButton{\n    height:40px; \n    width:80px;\n    background-color: #f44336; \n    margin-left:15px;\n    border: none;\n    color: white;\n    border-radius: 4px;\n}\nbutton.updateButton{\n    height:40px; \n    width:80px;\n    background-color: #ffff66; \n    margin-left:15px;\n    border: none;\n    color: black;\n    border-radius: 4px;\n}\n</style>\n\nthingID: <p/> <input type=\"text\" value=\"PIC32WK-B16B00\" id=\"thingID\"/><p>\n<button id=\"idConfigButton\" onclick=\"updateThingID()\" class=\"configButton\">configure</button>","height":2}},{"type":"html","settings":{"html":"<div id=\"updatedThingID\"/>","height":1}}]},{"title":"USB device information","width":1,"row":{"2":23,"3":15,"4":15},"col":{"2":2,"3":1,"4":1},"col_width":1,"widgets":[{"type":"text_widget","settings":{"title":"USB Device Name","size":"regular","value":"datasources[\"devStat\"][\"msg\"][\"usbName\"]","animate":true}},{"type":"text_widget","settings":{"title":"USB Device Serial","size":"regular","value":"datasources[\"devStat\"][\"msg\"][\"usbSer\"]","animate":true}}]},{"title":"Heartbeat","width":1,"row":{"2":27,"3":17},"col":{"2":1,"3":3},"col_width":1,"widgets":[{"type":"indicator","settings":{"title":"","value":"datasources[\"devStat\"][\"msg\"][\"hb\"]","on_text":"1","off_text":"0","color":"lgreen"}}]}],"datasources":[{"name":"devStat","type":"paho_mqtt","settings":{"server":"192.168.1.5","port":443,"use_ssl":false,"client_id":"","username":"","password":"","topic":"PIC32WK-B16B00","json_data":true,"name":"devStat"}}],"columns":3}
